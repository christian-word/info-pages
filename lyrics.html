<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è —Ç–∞ –ø–µ—Ä–µ–∫–ª–∞–¥ —Ç–µ–∫—Å—Ç—É –ø—ñ—Å–Ω—ñ</title>
  <style>
    :root {
      --bg: #f6f7fb;
      --card: #ffffff;
      --text: #222;
      --primary: #1a73e8;
      --success: #2f7d32;
      --danger: #b00020;
      --warning: #ff9800;
      --border: #e5e5e5;
      --hover: #f0f0f0;
    }
    [data-theme="dark"] {
      --bg: #1a1a1a;
      --card: #2d2d2d;
      --text: #ffffff;
      --border: #444;
      --hover: #383838;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      max-width: 800px;
      width: 100%;
      margin: 0 auto;
      background: var(--card);
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      margin-top: 0;
      color: var(--primary);
    }
    .description {
      text-align: center;
      color: var(--text);
      margin-bottom: 20px;
      font-size: 14px;
    }
    .form-group {
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
    }
    input[type="file"] {
      width: 100%;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--bg);
      color: var(--text);
      font-size: 16px;
    }
    select {
      width: 100%;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--bg);
      color: var(--text);
      font-size: 16px;
      margin-bottom: 15px;
    }
    button {
      width: 100%;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--primary);
      color: white;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    button:hover:not(:disabled) {
      background: #0d5cb6;
    }
    button:disabled {
      background: #cccccc;
      cursor: not-allowed;
    }
    .result {
      margin-top: 20px;
      padding: 16px;
      border-radius: 8px;
      background: var(--bg);
      border: 1px solid var(--border);
      white-space: pre-wrap;
      min-height: 50px;
    }
    .status {
      text-align: center;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .status.success {
      background: rgba(47, 125, 50, 0.1);
      color: var(--success);
      border: 1px solid var(--success);
    }
    .status.error {
      background: rgba(176, 0, 32, 0.1);
      color: var(--danger);
      border: 1px solid var(--danger);
    }
    .status.warning {
      background: rgba(255, 152, 0, 0.1);
      color: var(--warning);
      border: 1px solid var(--warning);
    }
    .hidden {
      display: none;
    }
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
      margin-right: 10px;
      vertical-align: middle;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    audio {
        width: 100%;
        margin-top: 10px;
    }
    .info-box {
      background-color: rgba(26, 115, 232, 0.1);
      border: 1px solid var(--primary);
      border-radius: 8px;
      padding: 12px;
      margin-top: 15px;
      font-size: 13px;
    }
    .actions {
        display: flex;
        gap: 10px;
        margin-top: 15px;
    }
    .actions button {
        flex: 1;
    }
    #save-btn {
        background: var(--success);
    }
    #save-btn:hover:not(:disabled) {
        background: #256528;
    }
    #copy-btn {
        background: #6c757d;
    }
    #copy-btn:hover:not(:disabled) {
        background: #5a6268;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üé§ –î–ª—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü–µ—Ä–∫–≤–∏</h1>
    <p class="description">–†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è —Ç–∞ –ø–µ—Ä–µ–∫–ª–∞–¥ —Ç–µ–∫—Å—Ç—É –ø—ñ—Å–Ω—ñ. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∞—É–¥—ñ–æ—Ñ–∞–π–ª (MP3, WAV, M4A) –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É –ø—ñ—Å–Ω—ñ</p>
    <div id="status" class="status hidden"></div>
    <div class="form-group">
      <label for="audio-file">–ê—É–¥—ñ–æ—Ñ–∞–π–ª:</label>
      <input type="file" id="audio-file" accept="audio/*" />
      <audio id="audio-preview" controls class="hidden"></audio>
      
      <label for="target-language">–ú–æ–≤–∞ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è/–ø–µ—Ä–µ–∫–ª–∞–¥—É:</label>
      <select id="target-language">
        <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
        <option value="en">–ê–Ω–≥–ª—ñ–π—Å—å–∫–∞</option>
        <option value="ru">–†–æ—Å—ñ–π—Å—å–∫–∞</option>
      </select>
    </div>
    <button id="transcribe-btn" disabled>
      <span id="button-text">–†–æ–∑–ø—ñ–∑–Ω–∞—Ç–∏ —Ç–∞ –ø–µ—Ä–µ–∫–ª–∞—Å—Ç–∏</span>
    </button>
    <div class="info-box">
      <strong>‚ÑπÔ∏è –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î:</strong> –¶—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º–æ–¥–µ–ª—å –®–Ü Whisper –¥–ª—è –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–≤–ª–µ–Ω–Ω—è –∑ –∞—É–¥—ñ–æ –≤ —Ç–µ–∫—Å—Ç. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–±—Ä–∞—Ç–∏ –º–æ–≤—É, –Ω–∞ —è–∫—ñ–π –±—É–¥–µ —Ä–æ–∑–ø—ñ–∑–Ω–∞–Ω–æ —Ç–µ–∫—Å—Ç. –ß–∏–º —á—ñ—Ç–∫—ñ—à–µ –∑–≤—É—á–∏—Ç—å —Å–ø—ñ–≤, —Ç–∏–º —Ç–æ—á–Ω—ñ—à–∏–º –±—É–¥–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
    </div>
    <div id="result-container" class="hidden">
        <div id="result" class="result"></div>
        <div class="actions">
            <button id="copy-btn">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
            <button id="save-btn">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
        </div>
    </div>
  </div>
  <script>
    /* =========================
      API CONFIGURATION
      ========================= */
    const encrypted = "Z3NrX1NUelQyS1FFQko3MGNDb1hDSllaV0dkeWIzRlk5OHJHN2xvWXUxSmc1SnV0VFZOSzIyVHY=";
    const apiKey = atob(encrypted);
    const API_URL = "https://api.groq.com/openai/v1/audio/transcriptions";
    /* =========================
      UTILITY FUNCTIONS
      ========================= */
    function showStatus(message, type = 'success') {
      const statusEl = document.getElementById('status');
      statusEl.textContent = message;
      statusEl.className = `status ${type}`;
      statusEl.classList.remove('hidden');
    }
    function hideStatus() {
      document.getElementById('status').classList.add('hidden');
    }
    function showResult(content) {
      const container = document.getElementById('result-container');
      const resultEl = document.getElementById('result');
      resultEl.textContent = content;
      container.classList.remove('hidden');
    }
    function hideResult() {
      document.getElementById('result-container').classList.add('hidden');
    }
    function setButtonLoading(isLoading) {
      const button = document.getElementById('transcribe-btn');
      const buttonText = document.getElementById('button-text');
      if (isLoading) {
        button.disabled = true;
        buttonText.innerHTML = '<span class="loading"></span> –û–±—Ä–æ–±–∫–∞...';
      } else {
        button.disabled = false;
        buttonText.textContent = '–†–æ–∑–ø—ñ–∑–Ω–∞—Ç–∏ —Ç–∞ –ø–µ—Ä–µ–∫–ª–∞—Å—Ç–∏';
      }
    }
    /* =========================
      AUDIO HANDLING
      ========================= */
    document.getElementById('audio-file').addEventListener('change', function(e) {
      const file = e.target.files[0];
      const button = document.getElementById('transcribe-btn');
      const preview = document.getElementById('audio-preview');
      if (file) {
        button.disabled = false;
        // –°—Ç–≤–æ—Ä—é—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥ –∞—É–¥—ñ–æ
        const url = URL.createObjectURL(file);
        preview.src = url;
        preview.classList.remove('hidden');
      } else {
        button.disabled = true;
        preview.classList.add('hidden');
        preview.src = '';
      }
    });
    /* =========================
      TRANSCRIPTION & TRANSLATION FUNCTION
      ========================= */
    async function transcribeAndTranslate() {
      hideStatus();
      hideResult();
      setButtonLoading(true);
      const fileInput = document.getElementById('audio-file');
      const languageSelect = document.getElementById('target-language');
      const file = fileInput.files[0];
      const targetLanguage = languageSelect.value;

      if (!file) {
        showStatus('–ë—É–¥—å –ª–∞—Å–∫–∞, –æ–±–µ—Ä—ñ—Ç—å –∞—É–¥—ñ–æ—Ñ–∞–π–ª', 'error');
        setButtonLoading(false);
        return;
      }
      // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É —Ñ–∞–π–ª—É (Groq –º–∞—î –ª—ñ–º—ñ—Ç 25MB)
      if (file.size > 25 * 1024 * 1024) {
        showStatus('–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä 25MB.', 'error');
        setButtonLoading(false);
        return;
      }
      const formData = new FormData();
      formData.append('file', file);
      formData.append('model', 'whisper-large-v3');
      formData.append('response_format', 'text');
      // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –º–æ–≤—É –¥–ª—è —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è/–ø–µ—Ä–µ–∫–ª–∞–¥—É
      formData.append('language', targetLanguage); 
      
      try {
        const res = await fetch(API_URL, {
          method: "POST",
          headers: {
            "Authorization": `Bearer ${apiKey}`
          },
          body: formData
        });
        if (!res.ok) {
          const errorText = await res.text().catch(() => "–ù–µ–º–∞—î –¥–µ—Ç–∞–ª–µ–π –ø–æ–º–∏–ª–∫–∏");
          throw new Error(`HTTP ${res.status}: ${errorText}`);
        }
        const transcript = await res.text();
        if (!transcript || transcript.trim() === '') {
          showResult('–ù–µ –≤–¥–∞–ª–æ—Å—è —Ä–æ–∑–ø—ñ–∑–Ω–∞—Ç–∏ —Ç–µ–∫—Å—Ç. –ú–æ–∂–ª–∏–≤–æ, –∞—É–¥—ñ–æ –∑–∞–Ω–∞–¥—Ç–æ —Ç–∏—Ö–µ, –≤—ñ–¥—Å—É—Ç–Ω—î –º–æ–≤–ª–µ–Ω–Ω—è –∞–±–æ —Ñ–∞–π–ª –ø–æ—à–∫–æ–¥–∂–µ–Ω–∏–π.');
        } else {
          showResult(transcript);
          showStatus(`–¢–µ–∫—Å—Ç –ø—ñ—Å–Ω—ñ —É—Å–ø—ñ—à–Ω–æ —Ä–æ–∑–ø—ñ–∑–Ω–∞–Ω–æ –Ω–∞ ${languageSelect.options[languageSelect.selectedIndex].text.toLowerCase()}!`, 'success');
        }
      } catch (err) {
        showResult('');
        showStatus(`–ü–æ–º–∏–ª–∫–∞: ${err.message}`, 'error');
        console.error("Transcription Error:", err);
      } finally {
        setButtonLoading(false);
      }
    }
    /* =========================
      SAVE & COPY FUNCTIONS
      ========================= */
    function copyToClipboard() {
        const resultText = document.getElementById('result').textContent;
        navigator.clipboard.writeText(resultText)
            .then(() => {
                showStatus('–¢–µ–∫—Å—Ç —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ –¥–æ –±—É—Ñ–µ—Ä–∞ –æ–±–º—ñ–Ω—É!', 'success');
            })
            .catch(err => {
                showStatus('–ü–æ–º–∏–ª–∫–∞ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è: ' + err, 'error');
            });
    }
    function saveToFile() {
        const resultText = document.getElementById('result').textContent;
        const blob = new Blob([resultText], { type: 'text/plain;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = '—Ç–µ–∫—Å—Ç_–ø—ñ—Å–Ω—ñ.txt';
        document.body.appendChild(a);
        a.click();
        // –û—á–∏—â—É—î–º–æ —Ä–µ—Å—É—Ä—Å–∏
        setTimeout(() => {
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }, 100);
    }
    /* =========================
      INITIALIZATION
      ========================= */
    document.addEventListener('DOMContentLoaded', () => {
      // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π
      document.getElementById('transcribe-btn').addEventListener('click', transcribeAndTranslate);
      document.getElementById('copy-btn').addEventListener('click', copyToClipboard);
      document.getElementById('save-btn').addEventListener('click', saveToFile);
    });
  </script>
</body>
</html>